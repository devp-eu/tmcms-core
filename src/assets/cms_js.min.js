function isIE(){return(window.navigator.appName=="Microsoft Internet Explorer")}function popup(a,b,c,j,i,h,g,f,d){if(empty(a)){var a=""}if(!isset(b)){var b=""}if(empty(c)){var c="100"}else{if(c=="fullscreen"){var c=screen.availWidth}else{c=c.toString();if(c.indexOf("%")!=-1){var c=(Math.round(parseInt(c)*screen.availWidth/100)).toString()}}}if(empty(j)){var j="100"}else{if(j==="fullscreen"){var j=screen.availHeight}else{j=j.toString();if(j.indexOf("%")!=-1){var j=(Math.round(parseInt(j)*screen.availHeight/100)).toString()}}}if(empty(i)&&c!=="fullscreen"){var i=(Math.round(screen.availWidth/2-parseInt(c)/2)).toString()}else{if(c==="fullscreen"){var i="0"}}if(empty(h)&&j!=="fullscreen"){var h=(Math.round(screen.availHeight/2-parseInt(j)/2)).toString()}else{if(j==="fullscreen"){var h="0"}}if(!isset(d)){var d=""}if(empty(g)){var g="dependent=1,width="+c+",height="+j;if(i!=""){g+=",screenX="+i+",left="+i}if(h!=""){g+=",screenY="+h+",top="+h}}else{if(!isset(g)){var g=""}if(i!=""&&g.indexOf("left=")===-1){g+=(g!=""?",":"")+"left="+i}if(i!=""&&g.indexOf("screenX=")===-1){g+=(g!=""?",":"")+"screenX="+i}if(h!=""&&g.indexOf("top=")===-1){g+=(g!=""?",":"")+"top="+h}if(h!=""&&g.indexOf("screenY=")===-1){g+=(g!=""?",":"")+"screenY="+h}if(g.indexOf("width=")===-1){g+=(g!=""?",":"")+"width="+c}if(g.indexOf("height=")===-1){g+=(g!=""?",":"")+"height="+j}}if(empty(f)){var f=""}else{if(f==="auto"){var f='<html><head><style>BODY{overflow:hidden;padding:0;margin:0;}</style><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="imagetoolbar" content="no" /></head><body onLoad="window.moveTo('+i+", "+h+');self.focus()" bgcolor="#fff">%content%</body></html>'}}var e=window.open(a,b,g);if(f!=""){if(!isIE()){e.document.open()}e.document.write(f.replace("%content%",d));e.document.close()}return e}function toggleAll(a,c,d){if(!isset(a)){return}if(!isset(c)){var c=""}if(!isset(d)){var d=0}else{d=parseInt(d)}var e;for(var b=d;true;b++){e=document.getElementById(a+b+c);if(e){if(e.style.display=="none"){e.style.display="block"}else{e.style.display="none"}}else{break}}}function toggle(d,a){if(typeof(d)=="string"){var c=document.getElementById(d)}else{var c=d}if(c){if(c.style.display=="none"){c.style.display="";if(isset(a)){var b=document.getElementById(a);if(b){b.focus()}}}else{c.style.display="none"}}return d}function toggleOn(b){if(typeof(b)=="string"){var a=document.getElementById(b)}else{var a=b}if(a){a.style.display=""}return b}function toggleOff(b){if(typeof(b)=="string"){var a=document.getElementById(b)}else{var a=b}if(a){a.style.display="none"}return b}function isset(a){return(typeof(a)=="undefined"?false:true)}var HTMLGen={settings:{countInterval:3000,hideHelpers:true},objects:{},register:{textarea:function(c,b,a){if(!document.getElementById(c)){return}if(a){HTMLGen.helpers.create(c,b,a)}},text:function(c,b,a){HTMLGen.register.textarea(c,b,a)}},helpers:{create:function(d,b,a){a=decodeURIComponent(a).replace(/\+/gm," ");document.getElementById(d).parentNode.innerHTML='<div style="position:relative">'+document.getElementById(d).parentNode.innerHTML+'<div style="visibility: hidden" class="cms_hint">'+a+"</div></div>";var c=document.getElementById(d);HTMLGen.objects[d]=c;if(b!=""){HTMLGen.storage.register(d,c,b)}HTMLGen.objects["help_"+d]=c.parentNode.lastChild;addEvent("focus",c,'HTMLGen.helpers.show("'+d+'")');addEvent("blur",c,'HTMLGen.helpers.hide("'+d+'")');HTMLGen.objects["cntr_"+d]=document.getElementById("cntr_"+d);addEvent("change",c,'HTMLGen.count("'+d+'")');addEvent("keyup",c,'HTMLGen.count("'+d+'")');setInterval('HTMLGen.count("'+d+'")',HTMLGen.settings.countInterval);HTMLGen.count(d)},show:function(a){if(!HTMLGen.storage.hint_blocked(a)){}HTMLGen.objects["help_"+a].style.visibility=""},hide:function(a){if(!HTMLGen.storage.hint_blocked(a)){HTMLGen.objects["help_"+a].style.visibility="hidden"}}},show_restore:function(a){document.getElementById(a+"_restore").style.visibility="visible";HTMLGen.helpers.show(a)},count:function(a){if(!HTMLGen.objects["cntr_"+a]||!HTMLGen.objects[a]){return}HTMLGen.objects["cntr_"+a].innerHTML=HTMLGen.objects[a].value.length;if($(HTMLGen.objects[a]).data("max")){if($(HTMLGen.objects[a]).data("max")<HTMLGen.objects[a].value.length){$(HTMLGen.objects["cntr_"+a]).parent().addClass("danger-hint")}else{$(HTMLGen.objects["cntr_"+a]).parent().removeClass("danger-hint")}}if($(HTMLGen.objects[a]).data("min")){if($(HTMLGen.objects[a]).data("min")>HTMLGen.objects[a].value.length){$(HTMLGen.objects["cntr_"+a]).parent().addClass("warning-hint")}else{$(HTMLGen.objects["cntr_"+a]).parent().removeClass("warning-hint")}}},storage:{objects:{},object_to_restore:{},store:false,interval:5000,expired:43200,storage_prefix:"cms",init:function(b){try{HTMLGen.storage.store=new Storage(HTMLGen.storage.storage_prefix+b);$(window).bind("beforeunload",HTMLGen.storage.save);HTMLGen.storage.load();HTMLGen.storage.save(true)}catch(a){}},register:function(c,b,a){HTMLGen.storage.objects[c]={object:b,md5:a}},startSaver:function(){setTimeout("HTMLGen.storage.save(true);",HTMLGen.storage.interval)},save:function(d){var a=HTMLGen.storage.getCurrentTs();for(var f in HTMLGen.storage.objects){if(HTMLGen.storage.object_to_restore[f]){continue}try{var b=a+HTMLGen.storage.objects[f].md5+HTMLGen.storage.objects[f].object.value;HTMLGen.storage.store.set(f,b)}catch(c){}}if(d===true){HTMLGen.storage.startSaver()}},load:function(){var a=HTMLGen.storage.getCurrentTs();for(var f in HTMLGen.storage.objects){var e=HTMLGen.storage.objects[f].object;var c=HTMLGen.storage.store.get(f);if(c){var d=c.substr(10,32);var b=c.substr(42);if(d===HTMLGen.storage.objects[f].md5&&e.value!==b){HTMLGen.storage.loadRestore(f,b)}}}HTMLGen.storage.clearOld()},hide:function(a){var b=document.getElementById(a+"_restore");b.parentNode.style.display="none";b.parentNode.removeChild(b);HTMLGen.storage.unblock(a)},clearOld:function(){var f=HTMLGen.storage.store.getStoragesKeyList();var h=f.length;var b=HTMLGen.storage.storage_prefix.length;var e=HTMLGen.storage.getCurrentTs();var d,g,a;for(var c=0;c<h;c++){d=f[c];if(d.substr(0,b)!==HTMLGen.storage.storage_prefix){continue}g=HTMLGen.storage.store.getByFullKey(d);a=parseInt(g.substr(0,10));if(isNaN(a)){continue}if(e-a>=HTMLGen.storage.expired){HTMLGen.storage.store.removeByFullKey(d)}}},getRestoVal:function(a){if(!isset(HTMLGen.storage.object_to_restore[a])||!isset(HTMLGen.storage.objects[a])){return false}return HTMLGen.storage.object_to_restore[a]},restore:function(a){if(!isset(HTMLGen.storage.object_to_restore[a])||!isset(HTMLGen.storage.objects[a])){return}HTMLGen.storage.objects[a].object.value=HTMLGen.storage.object_to_restore[a];delete HTMLGen.storage.object_to_restore[a];HTMLGen.storage.startSaver();document.getElementById(a+"_restore").innerHTML="Restored."},loadRestore:function(b,a){HTMLGen.storage.object_to_restore[b]=a;HTMLGen.show_restore(b)},hint_blocked:function(a){return isset(HTMLGen.storage.object_to_restore[a])},unblock:function(a){delete HTMLGen.storage.object_to_restore[a]},getCurrentTs:function(){var a=new Date;return parseInt(a.getTime()/1000)}}};function checkHiddenInvalid(c){var d=$(c).attr("form")?$("#"+$(c).attr("form")):$(c).parents("form");var a=true;var e={};var b;$("input,select,textarea",d).each(function(){if($(this).is(":hidden")&&$(this).is(":invalid")){console.log($(this).attr("name"),"is invalid");a=false;if($(this).parents(".tab-pane").length){b=$(this).parents(".tab-pane").attr("id");if(typeof e[b]=="undefined"){e[b]=true}}}});$("[data-toggle=tab]",d).each(function(g,f){if(typeof e[$(this).attr("href").substr(1)]!="undefined"){$(this).addClass("error")}else{$(this).removeClass("error")}});if(!a){Metronic.alert({container:"",place:"append",type:"danger",message:"Some data is invalid. Check not active tabs",close:true,reset:true,focus:true,closeInSeconds:0,icon:"warning"})}}function addEvent(ev,o,func,useCapture){if(!o){return false}if(isIE()){o.attachEvent("on"+ev,(typeof(func)=="string"?function(){eval(func)}:func))}else{o.addEventListener(ev,(typeof(func)=="string"?function(){eval(func)}:func),false)}}function time(){return new Date().getTime()}function rand(b,a){return Math.floor(Math.random()*((a+1)-b))+b}var HintHelp={show:function(f,j,c){var d=document.getElementById(f);if(!d){return}var a=document.getElementById(f+"_helper");if(!a){var b=document.createElement("DIV");b.id=f+"_helper";b.className="help_box";b.innerHTML=j;document.body.appendChild(b);a=b}var g=window.event||c;var i=g.pageX||g.clientX;var h=g.pageY||g.clientY;this.repositioning(a,i,h);a.style.visibility="visible"},repositioning:function(e,c,a){var d=c+parseInt(e.offsetWidth,10);var b=parseInt(document.body.offsetWidth,10);if(d>b){e.style.left=(b-(d-b)-70)+"px"}else{e.style.left=(c)+"px"}e.style.top=(a+10)+"px"},hide:function(a){var b=document.getElementById(a);if(!b){return}if(document.getElementById(a+"_helper")){document.getElementById(a+"_helper").style.visibility="hidden";return}}};function Storage(a){if(typeof a!=="string"||a===""){alert("Storage error. Name should not be an empty string.");return}this.store=localStorage;this.name=a}Storage.prototype.key=function(a){return this.name+"_"+a};Storage.prototype.get=function(a){return this.store.getItem(this.key(a))};Storage.prototype.set=function(a,b){this.store.setItem(this.key(a),b)};Storage.prototype.remove=function(a){this.store.removeItem(this.key(a))};Storage.prototype.removeByFullKey=function(a){this.store.removeItem(a)};Storage.prototype.getByFullKey=function(a){return this.store.getItem(a)};Storage.prototype.getStoragesKeyList=function(){var b=this.store.length,c=[],a=0;for(;a<b;a++){c.push(this.store.key(a))}return c};String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};function in_array(c,b){var d;for(d in b){if(b[d]==c){return true}}return false}function array_kick_by_value(e,d){var b=[];if(e instanceof Array){var a=0,f=e.length;for(;a<f;a++){if(d!=e[a]){b[b.length]=e[a]}}}else{var c;for(c in e){if(d!=e[c]){b[b.length]=e[c]}}}return b}function random_number(b,d,a){var c=b+(Math.random()*(d-b));return typeof a=="undefined"?Math.round(c):c.toFixed(a)}var cMenuCloseTime=999;var cMenu=false,cMenuTimeout;if($){$(document).ready(function(){$(document.body).click(closeCMenu)})}function dropCMenu(k,h,q,p,n,m,l){closeCMenu();if(!k){k=event}var b,g=0,f,j,d=h.length,a,c;b=document.createElement("div");b.setAttribute("id","cMenu");b.className="cMenu";f=document.body.appendChild(b);$("#cMenu").css("left",k.pageX).css("top",k.pageY);f.onmouseout=function(){cMenu=false};f.onmouseover=updateCMenu;j="";for(;g<d;g++){a=h[g]["url"];c=h[g]["js"];if(typeof(q)!=="undefined"){a=a.replace("%v1%",q);c=c.replace("%v1%",q)}if(typeof(p)!=="undefined"){a=a.replace("%v2%",p);c=c.replace("%v2%",p)}if(typeof(n)!=="undefined"){a=a.replace("%v3%",n);c=c.replace("%v3%",n)}if(typeof(m)!=="undefined"){a=a.replace("%v4%",m);c=c.replace("%v4%",m)}if(typeof(l)!=="undefined"){a=a.replace("%v5%",l);c=c.replace("%v5%",l)}j+='<div style="padding: 0 10px 0 10px; margin: 2px 0 2px 0;"><a href="'+a+'" onClick="'+c+'">\n'+h[g]["title"]+"\n</a></div>"}f.innerHTML=j;cMenu=false;if(cMenuTimeout){clearTimeout(cMenuTimeout)}cMenuTimeout=setTimeout("validateCMenu()",cMenuCloseTime);j=f=b=null;return false}function validateCMenu(){if(!cMenu){closeCMenu()}if(cMenuTimeout){clearTimeout(cMenuTimeout);cMenuTimeout=null}cMenuTimeout=setTimeout("validateCMenu()",cMenuCloseTime)}function updateCMenu(){cMenu=true}function closeCMenu(){var a=document.getElementById("cMenu");if(a){document.body.removeChild(a)}cMenu=false}var PopupModal=function(b){this.id=null;this.window=null;this.overlay=null;this.options={url:null,width:700,height:500,onclose:null,disable_autoresize:false,result_destination:null,result_callback:null};var d=$(window),c=$("body"),a=this;this.initialize=function(){$.extend(a.options,b);return a};this.showLoading=function(){c.append('<div id="cms_show_loading"></div>');var e=$("#cms_show_loading");e.css({display:"block",background:"url(/vendor/devp-eu/tmcms-core/src/assets/images/loading.gif) center no-repeat","background-color":"rgb(0, 0, 0)",position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px",opacity:"0.5","z-index":"19998"})};this.hideLoading=function(){$("#cms_show_loading").remove()};this.loadContent=function(e){a.window.load(e,function(){a.options.url=e;a.hideLoading()})};this.onReturnResult=function(e){if(typeof e==="function"){a.options.result_callback=e}};this.resize=function(){if(a.options.disable_autoresize){return}a.window.height(d.height()-100);a.window.width(d.width()-100);a.window.css("margin-left",-a.window.width()/2);a.window.css("margin-top",-a.window.height()/2)};this.close=function(){a.window.remove();a.overlay.remove();if(a.options.onclose=="reload"){location.reload()}};this.setTriggers=function(){a.window.on("popup:load_content",function(f,e){a.loadContent(e)});a.window.on("popup:return_result",function(f,e){if(a.options.result_destination){$.each(["",".","#"],function(h,i){var g=$(i+a.options.result_destination);if(g.length!=0){g.val(e);return false}})}if(a.options.result_callback){a.options.result_callback(e)}});a.window.on("popup:close",function(){a.close()})};this.show=function(){a.showLoading();var f=$('[id="modal-popup_inner"]');a.id=f.size()+1;c.append('<div id="modal-popup" data-popup-id="'+a.id+'"></div>');var e=$('#modal-popup[data-popup-id="'+a.id+'"]');e.css({display:"block",position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px","background-color":"rgb(0, 0, 0)",opacity:a.id==1?0.5:0,cursor:"pointer","z-index":64000+(f.size()*1500)});e.click(function(){a.close()});a.overlay=e;if(f.length>0){a.options.width=f.width();a.options.height=f.height()}c.append('<div id="modal-popup_inner" data-popup-id="'+a.id+'"><div class="content" style="height: auto; width: auto;"></div></div>');var g=$('#modal-popup_inner[data-popup-id="'+a.id+'"]');g.css({display:"block",position:"fixed",left:"50%",top:"50%","z-index":64000+((f.size()+1)*1500),opacity:"1",background:"#fff",overflow:"auto",height:a.options.height+"px",width:a.options.width+"px","margin-top":-(a.options.height/2)+"px","margin-left":-(a.options.width/2)+"px"});a.window=g;a.setTriggers();if(a.options.url){a.loadContent(a.options.url)}a.resize();d.resize(function(){a.resize()})};this.initialize()};var popup_modal={resize:function(){var a=$("#modal-popup_inner");var b=$(window);a.height(b.height()-100);a.width(b.width()-100);a.css("margin-left",-a.width()/2);a.css("margin-top",-a.height()/2)},show:function(b,c,a){this.show_loading();var d=$("#modal-popup_inner");if(d.length>0){c=d.width();a=d.height();popup_modal.close()}else{c=c||700;a=a||500}$("body").append('<div id="modal-popup" style="display: block; position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.5; z-index: 10000; cursor: pointer; background-color: rgb(0, 0, 0);" onclick="popup_modal.close()"></div>');$("body").append('<div id="modal-popup_inner" style="overflow: auto; left: 50%; position: fixed; top: 50%; z-index: 10001; opacity: 1; height: '+a+"px; width: "+c+"px; margin-top: -"+(a/2)+"px; margin-left: -"+(c/2)+'px; background: #fff; display: block;"><div class="content" style="height: auto; width: auto;"></div></div>');$("#modal-popup_inner").load(b+"&ajax",function(){popup_modal.hide_loading()});popup_modal.resize();$(window).resize(function(){popup_modal.resize()})},close:function(){$("#modal-popup, #modal-popup_inner").remove();if(popup_modal.reload_on_close){location.reload()}},result_element:"",reload_on_close:false,show_loading:function(){$("body").append('<div id="cms_show_loading" style="background: url(/vendor/devp-eu/tmcms-core/src/assets/images/loading.gif) center no-repeat; display: block; position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.5; z-index: 19998; background-color: rgb(0, 0, 0);"></div>')},hide_loading:function(){$("#cms_show_loading").remove()}};var cms_notifications={init:function(){if(("Notification" in window)&&Notification.permission!=="granted"){Notification.requestPermission()}},show:function(d,c,a){if(!("Notification" in window)){return}if(Notification.permission!=="granted"){return Notification.requestPermission()}if(!c){c=cms_data.site_name}if(!d){d="Visit page for more info"}var b=new Notification(c,{icon:typeof(cms_data.notification_icon)=="undefined"?"/vendor/devp-eu/tmcms-core/src/assets/images/logo_square.png":cms_data.notification_icon,body:d});if(a){b.onclick=function(){window.open(a);b.close()}}else{b.onclick=function(){window.focus();b.close()}}}};$(function(){cms_notifications.init();$(".menu_line_table_td var").click(function(){$("#menu_more").slideToggle()});setInterval(function(){$.get("?p=home&do=_ajax_keep_admin_session&ajax")},300000);if(typeof Switchery!="undefined"){$(".js-switch-cms").each(function(c,b){var d=new Switchery(b,{color:"green",secondaryColor:"red"})})}$("[data-popup-url]").click(function(c){c.preventDefault();var b=$(this);var d=new PopupModal({url:b.data("popup-url"),width:b.data("popup-width"),disable_autoresize:b.data("popup-disable-autoresize"),height:b.data("popup-height"),onclose:b.data("popup-onclose"),result_destination:b.data("popup-result-destination")});d.show()});$("[data-dialog-modal-url]").click(function(g){g.preventDefault();var d=$(this);var c=d.data("dialog-modal-url");popup_modal.result_element=$("#"+d.data("result-id"));var f=d.data("dialog-width");if(!f){f=700}var b=d.data("dialog-height");if(!b){b=500}var h=$(window);if(h.height()<b+40){b=h.height()-40}if(h.width()<f+40){f=h.width()-40}popup_modal.show(c,f,b)});var a=$(".datepicker");if(a.length>0){a.datepicker().each(function(c,b){var e=$(this);if(e.val()==""){var d=new Date();e.val(d.getFullYear()+"-"+("0"+d.getMonth()).slice(-2)+"-"+("0"+d.getDate()).slice(-2))}})}ajax_toasters.request_new_messages();$('.table a[href^="http://"], .table a[href^="https://"]').each(function(){$(this).attr("target","_blank")});$(".collapsable_fieldset legend").click(function(){var c=$(this);var b=c.parent("fieldset");b.find("div").toggle()})});var ajax_toasters={interval:null,request_new_messages:function(){if(!ajax_toasters.interval){ajax_toasters.interval=setInterval(ajax_toasters.request_new_messages,15000)}$.ajax({async:true,cache:false,dataType:"json",url:"?p=home&do=_ajax_get_notifications&ajax",success:function(b){for(var a in b){if(Notification&&b[a].notify=="0"){cms_notifications.show(b[a].message)}else{switch(parseInt(b[a].notify)){case 1:toastr.success(b[a].message);break;case 2:toastr.error(b[a].message);break;default:toastr.warning(b[a].message);break}}}},error:function(b,a){var c="";if(b.status===0){c="Not connect.\n Verify Network."}else{if(b.status==404){c="Requested page not found. [404]"}else{if(b.status==500){c="Internal Server Error [500]."}else{if(a==="parsererror"){c="Requested JSON parse failed."}else{if(a==="timeout"){c="Time out error."}else{if(a==="abort"){c="Ajax request aborted."}else{c="Uncaught Error.\n"+b.responseText}}}}}}toastr.error(c)}})}};function checkbox_by_ajax(c){var b=$(c);var a=b.closest("form");b.prop("disabled",true);$.post(a.attr("action")+"&ajax",a.serialize(),function(d){setTimeout(function(){b.prop("disabled",false);ajax_toasters.request_new_messages()},300)})}var multi_actions={registered_action:{},submit:function(b){var a=$(b);var d=a.val();var g=a.closest("table").attr("id");var f=multi_actions.registered_action[g];var e=f[d].link;var c=[];$("[data-table-id="+g+"]:checked").each(function(i,h){c.push($(this).data("id"))});if(f[d].confirm){if(!confirm("Are you sure?")){return}}location.href=e+"&ids="+c}};var clipboard_forms={copy_page_forms:function(){var a=[];$("form").each(function(b){a[b]=$(this).serialize()});window.prompt("Copy to clipboard: Ctrl+C, Enter",JSON.stringify(a))},paste_page_forms:function(){var b=window.prompt("Copy from clipboard: Ctrl+V, Enter");b=JSON.parse(b);var c;var a;$("form").each(function(e,d){c=b[e];a=$(d);$.each(c.split("&"),function(f,g){var h=g.split("=");a.find("[name='"+h[0]+"']").val(h[1])})})}};