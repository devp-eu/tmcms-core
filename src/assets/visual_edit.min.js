cms_visual_edit={default_string:"",init:function(){$(".cms_visual_editable").css({outline:"1px solid blue",cursor:"pointer"})},edit:function(a){$(".cms_visual_editable").css("outline","1px solid blue");a.contentEditable=true;a.style.outline="1px solid green";a.style.cursor="default";cms_visual_edit.load_btn(a);a.focus();this.default_string=$(a).html()},save:function(a){var b=$("#"+a);b.css({outline:"1px solid orange",cursor:""});$.ajax({type:"POST",url:"/-/api/visual_edit_save/",data:{content:b.html(),component:b.data("component"),page_id:b.data("page_id"),type:b.data("type")},dataType:"json",complete:function(c){if(c.status){b.css("outline","1px solid blue")}},error:function(){b.css("outline","1px solid red")}});cms_visual_edit.init();cms_visual_edit.hide_btn()},reset:function(a){var b=$("#"+a);b.html(cms_visual_edit.default_string);cms_visual_edit.init()},load_btn:function(a){this.hide_btn();$(a).after('<div id="visual_btn" style="position:absolute; z-index: 9999; background-color: #FFFFFF;";><button id="visual_save" style="padding: 3px; margin-top: 3px;" onclick="cms_visual_edit.save(\''+a.id+'\')">Update</button><button style="padding: 3px; margin-top: 3px;" onclick="cms_visual_edit.reset(\''+a.id+"')\">Reset</button></div>")},hide_btn:function(){$("#visual_btn").remove()}};$(function(){cms_visual_edit.init();var a=$(".cms_visual_editable");$(document).on("click",function(b){if(a.is(":visible")&&!a.is(b.target)&&!a.has(b.target).length){cms_visual_edit.init();cms_visual_edit.hide_btn()}})});